# AHC013

## Contest Link
- https://atcoder.jp/contests/ahc013

## やったこと

### 2022/08/11

#### sample_submission.cpp の大部分を真似する
- ありがたい
- (多分) 26047 点
#### ランダム解の生成をできるだけ繰り返して最良のものを選ぶように変更
- [AHC011の現時点におけるC++得点1位のコード](https://atcoder.jp/contests/ahc011/submissions/32267675) のTime関係を参考に
- 42509 点
#### connect 回数を減らして move 回数を増やしたらスコアが増えた
- 43592 点
#### 山登り法を実装したい
- 初期状態はランダム解そのままでOKそう
- 遷移が良くわからない
- 例えば move 回数を固定して一部の move を変更する、みたいなことをする場合、ある move がその後の move に影響を与える(各操作が独立ではない)
- とりあえず move のうち1つをランダムに決めて、それは確実に変化させ、他はそれまでの操作によって出来なくなってたら変化させるみたいなことをすることにする
- さらに適宜 additional_move_limit で move 回数を増やしたりする
- modify() がそれだけど、while(true)があることもあり結構無駄が多そう(特に空きマスが少ない場合)
    - そもそもこれいる？
- とりあえず 73033 点
- AtCoder のコードテストで動かすとSeed=1,N=30,K=3,に対して256回ループが回っているが、手元では45回くらい(途中経過の出力含む)
    - 手元では60秒くらい走らせたほうが良さそう
    - `g++ -std=gnu++17 a.cpp -o a.out -D_RUTHEN`
    - 300 秒くらい走らせたところ、まだ解が収束してなかった
        - 定数倍高速化も重要そう

#### calc_score の高速化
- 同じ種類のコンピュータにしか繋がないことにすると $N$ 成分からなる連結成分全体のスコアは $ \binom{ N }{ 2 } $なのでこれを使って高速化する
- AtCoder のコードテストで山登り法のループ回数が256から130000回くらいに(はっや)
- めちゃくちゃ得点伸びた (202557 点)
- ひとまず山登り法で局所解には到達してそう?
- 焼きなまし法やっていく


### 2022/08/12

#### 焼きなまし法を実装したい
- あらかじめ[誰でもできる焼きなまし法][gasin]を参照していたので割と変更は楽だった
- start_time, end_timeというのがよくわからない
- 5, 0にしたら1ケースだけWA……
- assert入れまくったら今度は通って意味不明
    - バグを埋め込んでいるかも……
    - しかもスコアは下がった (142196点)

#### modify関数を変える
- とりあえずmove数が減るようにもした(よく見たら増やしてばっかりだった、やばい)
- それに伴って move 数が0になったときの処理などが追加で必要になった

#### 疑問・ToDo等
- while(true) 減らし
- connect の方をいじる(大きめの連結成分ができたほうがスコアが大きくなるので、BFSでconnect していく、など)
- ある盤面に対し、一切移動できないとしたときの評価スコアの最大値は計算できるのか?
- 異なる種類のコンピュータに繋いだほうが良いことはあるのか?
- 初期ランダム解の生成部分はあきらかに高速化できる(わざわざfield[i][j]=='0'をチェックしてるのは無駄)


### 参考文献



- [gasin's blog, 誰でもできる焼きなまし法][gasin]

[gasin]: https://gasin.hatenadiary.jp/entry/2019/09/03/162613
